import{E as oe}from"./D02hnqhr.js";import{E as se,a as ae}from"./8KuP7wNO.js";import{q as V,s as O,v as q,x as b,y as le,o as j,z as P,w as u,A,B as I,n,C as K,D as F,F as T,G as B,H as R,I as N,J as ne,K as k,L as re,r as g,M as ue,c as ie,b as l,E as pe,d as h,t as de,a as ce}from"./Djh_mYXA.js";import{u as w,E as me}from"./CrQRpmZ7.js";import{E as fe,a as _e,b as ye}from"./BBnxmBXC.js";import"./8iQtqznr.js";import{u as ge}from"./DdeZJquS.js";import{u as be}from"./BqvSvEKS.js";import"./BAET0TdL.js";import"./D51JPPaq.js";import"./sxMpOXgJ.js";const G=Symbol("rowContextKey"),ve=["start","center","end","space-around","space-between","space-evenly"],we=["top","middle","bottom"],Re=V({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:ve,default:"start"},align:{type:String,values:we}}),Ne=O({name:"ElRow"}),$e=O({...Ne,props:Re,setup($){const a=$,p=q("row"),i=b(()=>a.gutter);le(G,{gutter:i});const f=b(()=>{const e={};return a.gutter&&(e.marginRight=e.marginLeft=`-${a.gutter/2}px`),e}),d=b(()=>[p.b(),p.is(`justify-${a.justify}`,a.justify!=="start"),p.is(`align-${a.align}`,!!a.align)]);return(e,v)=>(j(),P(F(e.tag),{class:I(n(d)),style:K(n(f))},{default:u(()=>[A(e.$slots,"default")]),_:3},8,["class","style"]))}});var Ce=T($e,[["__file","row.vue"]]);const Ee=B(Ce),xe=V({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:R([Number,Object]),default:()=>N({})},sm:{type:R([Number,Object]),default:()=>N({})},md:{type:R([Number,Object]),default:()=>N({})},lg:{type:R([Number,Object]),default:()=>N({})},xl:{type:R([Number,Object]),default:()=>N({})}}),he=O({name:"ElCol"}),Oe=O({...he,props:xe,setup($){const a=$,{gutter:p}=ne(G,{gutter:b(()=>0)}),i=q("col"),f=b(()=>{const e={};return p.value&&(e.paddingLeft=e.paddingRight=`${p.value/2}px`),e}),d=b(()=>{const e=[];return["span","offset","pull","push"].forEach(s=>{const y=a[s];k(y)&&(s==="span"?e.push(i.b(`${a[s]}`)):y>0&&e.push(i.b(`${s}-${a[s]}`)))}),["xs","sm","md","lg","xl"].forEach(s=>{k(a[s])?e.push(i.b(`${s}-${a[s]}`)):re(a[s])&&Object.entries(a[s]).forEach(([y,C])=>{e.push(y!=="span"?i.b(`${s}-${y}-${C}`):i.b(`${s}-${C}`))})}),p.value&&e.push(i.is("guttered")),[i.b(),e]});return(e,v)=>(j(),P(F(e.tag),{class:I(n(d)),style:K(n(f))},{default:u(()=>[A(e.$slots,"default")]),_:3},8,["class","style"]))}});var je=T(Oe,[["__file","col.vue"]]);const Se=B(je),ke={style:{margin:"15px"}},Ve={class:"btn-group",style:{display:"flex"}},ze={__name:"index",async setup($){let a,p;const{loading:i}=ge(),f=g(!0),d=g([]),e=g(1),v=g(2),c=g(),s=g({room_No:"",description:"",max_Audience:0,deleted:"0",room_Id:""}),y=g({room_No:[{required:!0,message:"必填",trigger:"blur"}],description:[{required:!0,message:"必填",trigger:"blur"}]}),C=b(()=>{const t=JSON.parse(JSON.stringify(d.value)),o=(e.value-1)*v.value,r=e.value*v.value;return t.slice(o,r)}),{data:D}=([a,p]=ue(()=>be("/api/GetRooms",{onRequest({request:t,options:o}){i.value=!0},onRequestError({request:t,options:o,error:r}){},onResponse({response:t}){return i.value=!1,t._data},onResponseError({request:t,response:o,options:r}){}},"$CjNEPcXlW3")),a=await a,p(),a);d.value=D.value.data;const H=t=>{e.value=t},z=t=>{t&&t.validate(o=>{o?f.value?U(s.value):W(s.value):pe({message:"資料填寫錯誤",type:"error",duration:5e3,showClose:!0})})},J=t=>{t&&(t.resetFields(),f.value=!0)},L=t=>{s.value={...s.value,...t},f.value=!1},M=t=>{X(t)},U=async t=>{var r;if((await w("/api/AddRoom",{method:"POST",body:t})).isOK){const m=await w("/api/GetRooms",null,!1);d.value=m==null?void 0:m.data,e.value=1,(r=c==null?void 0:c.value)==null||r.resetFields()}},W=async t=>{var r;if((await w("/api/EditRoom",{method:"POST",body:t})).isOK){const m=await w("/api/GetRooms",null,!1);d.value=m==null?void 0:m.data,(r=c==null?void 0:c.value)==null||r.resetFields()}},X=async t=>{if((await w("/api/DelRoom",{method:"POST",body:t})).isOK){const r=await w("/api/GetRooms",null,!1);d.value=r==null?void 0:r.data}};return(t,o)=>{const r=oe,m=ae,S=Se,Q=Ee,Y=se,E=me,x=ye,Z=fe,ee=_e;return j(),ie("div",ke,[l(Y,{ref_key:"formRef",ref:c,"label-position":"top","require-asterisk-position":"right","scroll-to-error":"",model:n(s),rules:n(y)},{default:u(()=>[l(Q,{gutter:20},{default:u(()=>[l(S,{span:6},{default:u(()=>[l(m,{label:"教室編號",prop:"room_No"},{default:u(()=>[l(r,{modelValue:n(s).room_No,"onUpdate:modelValue":o[0]||(o[0]=_=>n(s).room_No=_)},null,8,["modelValue"])]),_:1})]),_:1}),l(S,{span:6},{default:u(()=>[l(m,{label:"廠區代號+教室名稱",prop:"description"},{default:u(()=>[l(r,{modelValue:n(s).description,"onUpdate:modelValue":o[1]||(o[1]=_=>n(s).description=_)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),l(E,{type:"primary",plain:"",onClick:o[2]||(o[2]=_=>z(n(c)))},{default:u(()=>[h(de(n(f)?"新增":"修改"),1)]),_:1}),l(E,{plain:"",onClick:o[3]||(o[3]=_=>J(n(c)))},{default:u(()=>o[4]||(o[4]=[h("清除")])),_:1}),l(Z,{style:{"margin-top":"20px"},data:n(C),"table-layout":"auto","row-key":"room_Id"},{default:u(()=>[l(x,{prop:"room_Id",label:"room_Id"}),l(x,{prop:"room_No",label:"room_No"}),l(x,{prop:"description",label:"description"}),l(x,{width:"60",label:"Views"},{default:u(({row:_})=>[ce("div",Ve,[l(E,{size:"small",type:"primary",onClick:te=>L(_)},{default:u(()=>o[5]||(o[5]=[h("修改")])),_:2},1032,["onClick"]),l(E,{size:"small",type:"danger",onClick:te=>M(_)},{default:u(()=>o[6]||(o[6]=[h("刪除")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),l(ee,{style:{"margin-top":"10px"},class:"card-list-pagination mt-4 mb-0",layout:"prev, pager, next, jumper","page-size":n(v),total:n(d).length,"current-page":n(e),onCurrentChange:H},null,8,["page-size","total","current-page"])])}}};export{ze as default};
