import{E as se}from"./CNLz94VT.js";import{E as ae,a as ne}from"./Bcim-ShI.js";import{s as B,v as q,x as U,y as v,z as le,o as L,A as z,w as m,B as H,C as J,n as i,D as M,F as Q,G as W,H as X,I as C,J as E,K as re,L as G,M as ue,N as w,O as ie,P as ce,Q as pe,r as h,R as de,c as me,b as u,E as fe,d as S,t as _e,a as ye}from"./Upv7kCFk.js";import{E as ge}from"./BjsRaJC9.js";import{E as be,a as ve,b as he}from"./Ccw75L6M.js";import"./Bb-Yxp_A.js";import{u as we}from"./9ykqRWfC.js";import{u as Re}from"./D72mB9ZY.js";import{u as $}from"./q-nG4QZC.js";import"./CMPuypk6.js";const Y=Symbol("rowContextKey"),$e=["start","center","end","space-around","space-between","space-evenly"],Ce=["top","middle","bottom"],Ee=B({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:$e,default:"start"},align:{type:String,values:Ce}}),Ne=q({name:"ElRow"}),xe=q({...Ne,props:Ee,setup(_){const o=_,c=U("row"),n=v(()=>o.gutter);le(Y,{gutter:n});const p=v(()=>{const e={};return o.gutter&&(e.marginRight=e.marginLeft=`-${o.gutter/2}px`),e}),l=v(()=>[c.b(),c.is(`justify-${o.justify}`,o.justify!=="start"),c.is(`align-${o.align}`,!!o.align)]);return(e,y)=>(L(),z(Q(e.tag),{class:J(i(l)),style:M(i(p))},{default:m(()=>[H(e.$slots,"default")]),_:3},8,["class","style"]))}});var Oe=W(xe,[["__file","row.vue"]]);const ke=X(Oe),je=B({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:C([Number,Object]),default:()=>E({})},sm:{type:C([Number,Object]),default:()=>E({})},md:{type:C([Number,Object]),default:()=>E({})},lg:{type:C([Number,Object]),default:()=>E({})},xl:{type:C([Number,Object]),default:()=>E({})}}),Se=q({name:"ElCol"}),qe=q({...Se,props:je,setup(_){const o=_,{gutter:c}=re(Y,{gutter:v(()=>0)}),n=U("col"),p=v(()=>{const e={};return c.value&&(e.paddingLeft=e.paddingRight=`${c.value/2}px`),e}),l=v(()=>{const e=[];return["span","offset","pull","push"].forEach(s=>{const g=o[s];G(g)&&(s==="span"?e.push(n.b(`${o[s]}`)):g>0&&e.push(n.b(`${s}-${o[s]}`)))}),["xs","sm","md","lg","xl"].forEach(s=>{G(o[s])?e.push(n.b(`${s}-${o[s]}`)):ue(o[s])&&Object.entries(o[s]).forEach(([g,R])=>{e.push(g!=="span"?n.b(`${s}-${g}-${R}`):n.b(`${s}-${R}`))})}),c.value&&e.push(n.is("guttered")),[n.b(),e]});return(e,y)=>(L(),z(Q(e.tag),{class:J(i(l)),style:M(i(p))},{default:m(()=>[H(e.$slots,"default")]),_:3},8,["class","style"]))}});var Te=W(qe,[["__file","col.vue"]]);const Ae=X(Te);function De(_,o,c){const[n={},p]=typeof o=="string"?[{},o]:[o,c],l=v(()=>w(_)),e=n.key||ie([p,typeof l.value=="string"?l.value:"",...Ve(n)]);if(!e||typeof e!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+e);const y=e===p?"$f"+e:e;if(!n.baseURL&&typeof l.value=="string"&&l.value[0]==="/"&&l.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:f,lazy:s,default:g,transform:R,pick:T,watch:N,immediate:A,getCachedData:D,deep:V,dedupe:F,...P}=n,x=ce({...pe,...P,cache:typeof n.cache=="boolean"?void 0:n.cache}),I={server:f,lazy:s,default:g,transform:R,pick:T,immediate:A,getCachedData:D,deep:V,dedupe:F,watch:N===!1?[]:[x,l,...N||[]]};let t;return Re(y,()=>{var O;(O=t==null?void 0:t.abort)==null||O.call(t,"Request aborted as another request to the same endpoint was initiated."),t=typeof AbortController<"u"?new AbortController:{};const r=w(n.timeout);let d;return r&&(d=setTimeout(()=>t.abort("Request aborted due to timeout."),r),t.signal.onabort=()=>clearTimeout(d)),(n.$fetch||globalThis.$fetch)(l.value,{signal:t.signal,...x}).finally(()=>{clearTimeout(d)})},I)}function Ve(_){var c;const o=[((c=w(_.method))==null?void 0:c.toUpperCase())||"GET",w(_.baseURL)];for(const n of[_.params||_.query]){const p=w(n);if(!p)continue;const l={};for(const[e,y]of Object.entries(p))l[w(e)]=w(y);o.push(l)}return o}const Fe={style:{margin:"15px"}},Pe={class:"btn-group",style:{display:"flex"}},Qe={__name:"index",async setup(_){let o,c;const{loading:n}=we(),p=h(!0),l=h([]),e=h(1),y=h(2),f=h(),s=h({room_No:"",description:"",max_Audience:0,deleted:"0",room_Id:""}),g=h({room_No:[{required:!0,message:"必填",trigger:"blur"}],description:[{required:!0,message:"必填",trigger:"blur"}]}),R=v(()=>{const t=JSON.parse(JSON.stringify(l.value)),a=(e.value-1)*y.value,r=e.value*y.value;return t.slice(a,r)}),{data:T}=([o,c]=de(()=>De("/api/GetRooms",{onRequest({request:t,options:a}){n.value=!0},onRequestError({request:t,options:a,error:r}){},onResponse({response:t}){return n.value=!1,t._data},onResponseError({request:t,response:a,options:r}){}},"$CjNEPcXlW3")),o=await o,c(),o);l.value=T.value.data;const N=t=>{e.value=t},A=t=>{t&&t.validate(a=>{a?p.value?P(s.value):x(s.value):fe({message:"資料填寫錯誤",type:"error",duration:5e3,showClose:!0})})},D=t=>{t&&(t.resetFields(),p.value=!0)},V=t=>{s.value={...s.value,...t},p.value=!1},F=t=>{I(t)},P=async t=>{var r;if((await $("/api/AddRoom",{method:"POST",body:t})).isOK){const d=await $("/api/GetRooms",null,!1);l.value=d==null?void 0:d.data,e.value=1,(r=f==null?void 0:f.value)==null||r.resetFields()}},x=async t=>{var r;if((await $("/api/EditRoom",{method:"POST",body:t})).isOK){const d=await $("/api/GetRooms",null,!1);l.value=d==null?void 0:d.data,(r=f==null?void 0:f.value)==null||r.resetFields()}},I=async t=>{if((await $("/api/DelRoom",{method:"POST",body:t})).isOK){const r=await $("/api/GetRooms",null,!1);l.value=r==null?void 0:r.data}};return(t,a)=>{const r=se,d=ne,K=Ae,O=ke,Z=ae,k=ge,j=he,ee=be,te=ve;return L(),me("div",Fe,[u(Z,{ref_key:"formRef",ref:f,"label-position":"top","require-asterisk-position":"right","scroll-to-error":"",model:i(s),rules:i(g)},{default:m(()=>[u(O,{gutter:20},{default:m(()=>[u(K,{span:6},{default:m(()=>[u(d,{label:"教室編號",prop:"room_No"},{default:m(()=>[u(r,{modelValue:i(s).room_No,"onUpdate:modelValue":a[0]||(a[0]=b=>i(s).room_No=b)},null,8,["modelValue"])]),_:1})]),_:1}),u(K,{span:6},{default:m(()=>[u(d,{label:"廠區代號+教室名稱",prop:"description"},{default:m(()=>[u(r,{modelValue:i(s).description,"onUpdate:modelValue":a[1]||(a[1]=b=>i(s).description=b)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),u(k,{type:"primary",plain:"",onClick:a[2]||(a[2]=b=>A(i(f)))},{default:m(()=>[S(_e(i(p)?"新增":"修改"),1)]),_:1}),u(k,{plain:"",onClick:a[3]||(a[3]=b=>D(i(f)))},{default:m(()=>a[4]||(a[4]=[S("清除")])),_:1}),u(ee,{style:{"margin-top":"20px"},data:i(R),"table-layout":"auto","row-key":"room_Id"},{default:m(()=>[u(j,{prop:"room_Id",label:"room_Id"}),u(j,{prop:"room_No",label:"room_No"}),u(j,{prop:"description",label:"description"}),u(j,{width:"60",label:"Views"},{default:m(({row:b})=>[ye("div",Pe,[u(k,{size:"small",type:"primary",onClick:oe=>V(b)},{default:m(()=>a[5]||(a[5]=[S("修改")])),_:2},1032,["onClick"]),u(k,{size:"small",type:"danger",onClick:oe=>F(b)},{default:m(()=>a[6]||(a[6]=[S("刪除")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),u(te,{style:{"margin-top":"10px"},class:"card-list-pagination mt-4 mb-0",layout:"prev, pager, next, jumper","page-size":i(y),total:i(l).length,"current-page":i(e),onCurrentChange:N},null,8,["page-size","total","current-page"])])}}};export{Qe as default};
